import{h as p}from"./http-fbdac65a.js";import{e as y,f as E,a as f,o as N,c as S,b as I,d as l,w as c,h as w,i as B,j as m,t as M}from"./index-f68cef2b.js";const R=u=>p("notice/post",u,"POST"),T=u=>p("notice/edit",u,"POST"),D=u=>p("notice/findRecent"),O=u=>p("notice/getById",u),_={post:R,edit:T,findRecent:D,getById:O};const L={class:"notice"},P=I("h1",null,"公告发布",-1),U={class:"btn-container"},z={__name:"Notice",setup(u){const s=y({noticeId:"",title:"",content:""}),i=y(null);E(v);const n=y(!1);function V(){return n.value?"success":"primary"}function b(){return n.value?"保存":"编辑"}async function x(){const o=n.value;if(n.value=!o,o){const e=await _.edit({...s.value,noticeId:i.value}),{code:t,msg:a}=e;ElMessage({message:a,type:t}),v()}}async function C(){const o=n.value;n.value=!o;const e=await _.post(s.value),{code:t,msg:a}=e;ElMessage({message:a,type:t}),v()}function h(){n.value=!1}async function k(o){if(!i){ElMessage({message:"当前还没有公告",type:"error"});return}const e=o==="last"?i.value-1:i.value+1,t=await _.getById({noticeId:e,type:o}),{noticeData:a,code:d,msg:g}=t;d==="success"?(i.value=a.noticeId,delete a.noticeId,s.value=a):ElMessage({message:g,type:d})}async function v(){const o=await _.findRecent(),{noticeData:e}=o;i.value=e.noticeId,s.value=e}return(o,e)=>{const t=f("el-button"),a=f("el-input"),d=f("el-form-item"),g=f("el-form");return N(),S("div",L,[P,I("div",U,[l(t,{type:V(),onClick:x},{default:c(()=>[m(M(b()),1)]),_:1},8,["type"]),n.value?(N(),w(t,{key:0,type:"success",onClick:C},{default:c(()=>[m("新增")]),_:1})):B("",!0),n.value?(N(),w(t,{key:1,onClick:h},{default:c(()=>[m("取消")]),_:1})):B("",!0),l(t,{onClick:e[0]||(e[0]=r=>k("last"))},{default:c(()=>[m("上一条公告")]),_:1}),l(t,{onClick:e[1]||(e[1]=r=>k("next"))},{default:c(()=>[m("下一条公告")]),_:1})]),l(g,{disabled:!n.value},{default:c(()=>[l(d,{label:"标题"},{default:c(()=>[l(a,{modelValue:s.value.title,"onUpdate:modelValue":e[2]||(e[2]=r=>s.value.title=r),placeholder:"标题"},null,8,["modelValue"])]),_:1}),l(d,{label:"内容"},{default:c(()=>[l(a,{modelValue:s.value.content,"onUpdate:modelValue":e[3]||(e[3]=r=>s.value.content=r),autosize:{minRows:18},maxlength:"960","show-word-limit":"",type:"textarea",placeholder:"在这里输入公告"},null,8,["modelValue"])]),_:1})]),_:1},8,["disabled"])])}}};export{z as default};
